<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
    <title></title>
    <!-- 引入样式文件 -->
    <link rel="stylesheet" href="https://oss.laisitech.com/ccd1029d-8dd1-442a-94a7-5205ee2ff9f5.css">
    <link rel="stylesheet" href="../../common/css/basic.css">
    <link rel="stylesheet" href="css/normal.css">
    <link rel="stylesheet" href="../club/css/clubCreateCompetition.css">
    <link rel="stylesheet" href="../font/iconfont.css">
    <link href="../clubList_Detail/css/header.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" id="themeCssLink2" href="../../common/css/theme_white.css">

    <style type="text/css">
        .infomation {
            margin: 1.2rem auto;
            line-height: .4rem;
            width: 6.3rem;
            font-size: .28rem;
            color: var(--textColor2);
            text-align: center;
        }
        
        .van-hairline--top-bottom::after,
        .van-hairline-unset--top-bottom::after {
            border-width: 0 0 0.02rem 0;
        }
        
        .van-cell-group {
            width: 85%;
            margin: 0 auto;
            padding: 0 .5rem;
        }
        
        .van-field__control {
            text-align: center;
        }
        
        .van-field__control {
            padding: 0;
        }
    </style>
</head>

<body>
    <div id="app" class="normalHeader" v-cloak>
        <div class="header">
            <van-nav-bar @click-left="onclickLeft" title="我在俱乐部的昵称" left-arrow safe-area-inset-top fixed>
                <template #left>
					<span class="icon iconfont icon-fanhuianniu" style="font-size: 0.5rem;" />
				</template>

            </van-nav-bar>
        </div>

        <div class="infomation">
            修改我在俱乐部的昵称，昵称修改后，只会在此俱乐部内有效，俱乐部内成员都可看见。
        </div>
        <van-cell-group>
            <van-field v-model="nickname" maxlength="8" clearable placeholder="请输入昵称"></van-field>
        </van-cell-group>
        <van-button round class="submit" block @click="changeName(nickname)" :color="nickname&&oldname!=nickname?bgc:bgcgrey">完成
        </van-button>
    </div>
</body>
<script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
<script src="https://cdn.jsdelivr.net/npm/vant@2.12/lib/vant.min.js"></script>
<script src="../../common/js/network.js"></script>
<script type="text/javascript">
    new Vue({
        el: '#app',
        data() {
            return {
                bgc: "linear-gradient(to right, #FF6A88, #FF5136 )",
                bgcgrey: '#999',
                nickname: getQueryString('name'),
                oldname: getQueryString('name'),
                clubid: getQueryString('id')
            };
        },
        created() {},
        methods: {
            onclickLeft() {
                window.history.back(-1);
            },
            changeName(nickname) {
                if (!nickname) return;
                let _self = this;
                ajax({
                    type: "post",
                    url: "club/updateClubGroupNickname",
                    data: {
                        nickname: _self.nickname,
                        clubId: _self.clubid,
                        memberId: JSON.parse(localStorage.getItem("appInfo")).userId
                    },
                    success: function(res) {
                        if (res.code == 0) {
                            _self.$toast("修改昵称成功！");
                            localStorage.setItem('settingChange', 1);
                            setTimeout(function() {
                                _self.OnclickLeft();
                            }, 1000)
                        } else {
                            _self.$toast(res.msg);
                        }
                    },
                    error: function() {
                        console.log("error")
                    }
                })
            }
        }
    })
</script>