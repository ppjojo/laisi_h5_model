<!DOCTYPE html>
<html lang="zh-cmn-Hans">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
    <title>邀请好友</title>
    <!-- 引入样式文件 -->
    <link rel="stylesheet" href="https://oss.laisitech.com/ccd1029d-8dd1-442a-94a7-5205ee2ff9f5.css">
    <link rel="stylesheet" href="font/iconfont.css">
    <link rel="stylesheet" id="themeCssLink" href="../common/css/theme_white.css">

    <style type="text/css">
        body {
            background-color: var(--bgColor);
            color: var(--textColor);
            height: 100vh;
        }
        /* 导航栏 */
        
        .normalHeader {
            height: 0.92rem;
            position: relative;
            z-index: 100;
        }
        
        .normalHeader .van-nav-bar {
            background-color: var(--bgColor);
        }
        
        .normalHeader .van-nav-bar .van-nav-bar__content {
            color: var(--textColor);
        }
        
        .normalHeader .van-nav-bar .van-nav-bar__title {
            color: var(--textColor);
        }
        
        .normalHeader .van-hairline--bottom::after {
            border: none;
        }
        
        .normalHeader .color999 {
            color: var(--textCol2);
        }
        /* 搜索框 */
        
        .searchBox {
            position: sticky;
            top: 0.918rem;
            width: 100%;
            z-index: 99;
        }
        
        .van-search {
            background-color: var(--bgColor);
        }
        
        .searchBox .van-search .van-icon-search {
            color: var(--textColor);
        }
        
        .searchBox .van-search .van-search__content {
            background-color: var(--borderColor);
        }
        
        .searchBox .van-search .van-field__control {
            color: var(--textColor);
        }
        /* 索引 */
        
        .van-index-anchor {
            color: var(--textColor);
        }
        
        .van-index-anchor--sticky {
            background-color: var(--bgColor);
            top: 2rem;
        }
        
        .van-index-bar__sidebar {
            top: 50%;
        }
        
        .van-hairline--bottom::after {
            border: none;
        }
        
        @supports ((height: constant(safe-area-inset-top)) or (height: env(safe-area-inset-top))) and (-webkit-overflow-scrolling: touch) {
            .normalHeader {
                height: 0.92rem;
                height: calc(0.92rem + constant(safe-area-inset-top));
                height: calc(0.92rem + env(safe-area-inset-top));
            }
            .searchBox {
                top: 0.92rem;
                top: calc(0.92rem + constant(safe-area-inset-top));
                top: calc(0.92rem + env(safe-area-inset-top));
            }
            .van-index-anchor--sticky {
                top: 2rem;
                top: calc(2rem + constant(safe-area-inset-top));
                top: calc(2rem + env(safe-area-inset-top));
            }
        }
        
        .van-cell-group {
            background-color: var(--bgColor);
        }
        
        .van-cell {
            background-color: var(--bgColor);
            color: var(--textColor);
        }
        
        .van-cell--clickable:active {
            background-color: transparent;
        }
        
        .van-hairline--top-bottom::after,
        .van-hairline-unset--top-bottom::after {
            border: none;
        }
        
        .van-cell::after {
            border-color: var(--borderColor);
        }
        
        .van-checkbox {
            margin-right: .2rem;
        }
        
        .van-checkbox__icon--checked .van-icon {
            background-color: #FF4E3E;
            border-color: #FF4E3E;
        }
        
        .itemBox {
            display: flex;
            align-items: center;
            justify-content: flex-start;
        }
        
        .itemBox .headpic {
            height: 0.8rem;
            height: 0.8rem;
            border-radius: 50%;
            margin-right: 0.2rem;
        }
        
        .noDataBox {
            padding-top: 3rem;
            text-align: center;
        }
        
        .noDataImg {
            width: 4rem;
            height: 4rem;
            background-image: var(--noData);
            background-size: cover;
            margin: 0 auto;
        }
        
        .noDataInfo {
            color: var(--textColor2);
            line-height: 0.8rem;
            font-size: 0.28rem;
        }
    </style>
</head>

<body>
    <div id="app" v-cloak>
        <div class="header normalHeader">
            <van-nav-bar @click-left="onclickLeft" title="提醒谁看" @click-right="onClickRight" left-arrow safe-area-inset-top fixed>
                <template #left>
					<span class="icon iconfont icon-fanhuianniu" style="font-size: 0.5rem;" />
				</template>
                <template #right>
					<div :class="chooseList.length>0?'':'color999'">完成</div>
				</template>
            </van-nav-bar>
        </div>
        <div class="searchBox">
            <van-search v-model="searchval" @input="initList" shape="round" placeholder="请输入成员昵称或ID">
            </van-search>
        </div>


        <van-checkbox-group v-model="chooseList">
            <!-- <van-cell-group v-show="searchval&&searchList.length>0">
				<template>
					<van-cell v-for="(item,index) in searchList" clickable :key="item.userId"
						@click="toggle(index,item)">
						<template #icon>
							<van-checkbox :name="item.userId" ref="checkboxes"></van-checkbox>
						</template>
						<template #title>
							<div class="itemBox">
								<img class="headpic" :src="item.headPictureUrl" alt="">
								<div class="nickname van-ellipsis">{{item.nickName}}</div>
							</div>
						</template>
					</van-cell>
				</template>
			</van-cell-group> -->
            <!-- <div v-show="!searchval||searchval==''"> -->
            <div v-if="indexList.length>0">
                <van-cell-group v-model="chooseList">
                    <van-index-bar :index-list="indexList">
                        <template v-if="Object.keys(dataList).length>0" v-for="(item,key,index) in dataList">
							<van-index-anchor :index="key.toUpperCase()"></van-index-anchor>
							<van-cell v-for="(item2,index2) in item" clickable :key="item2.userId"
								@click="toggle(index2,item2)">
								<template #icon>
									<van-checkbox :name="item2.userId" ref="checkboxes"></van-checkbox>
								</template>
                        <template #title>
									<div class="itemBox">
										<img class="headpic" :src="item2.headPictureUrl" alt="">
										<div class="nickname van-ellipsis">{{item2.nickName}}</div>
									</div>
								</template>
                        </van-cell>
                        </template>
                    </van-index-bar>
                </van-cell-group>
            </div>
            <div v-else-if="finished">
                <div class="noDataBox">
                    <div class="noDataImg"></div>
                    <p class="noDataInfo">没有搜索到相关关注，换个词试试；</p>
                </div>
            </div>
        </van-checkbox-group>
    </div>
</body>
<script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
<script src="https://cdn.jsdelivr.net/npm/vant@2.12/lib/vant.min.js"></script>
<script src="../common/js/network.js"></script>

<script>
    new Vue({
        el: '#app',
        data() {
            return {
                chooseList: [],
                searchval: "",
                searchList: [],
                dataList: [],
                indexList: [],
                finished: false,
            }
        },
        filters: {},
        mounted() {},
        created() {
            this.searchval = ""
            this.initList()
        },
        methods: {
            initList() {
                this.finished = false;
                ajax({
                    url: "community/threeCommendRefer/see/all/Refer",
                    data: {
                        key: this.searchval,
                    },
                }).then(res => {
                    this.dataList = res.data;
                    this.indexList = []
                    for (const key in this.dataList) {
                        this.indexList.push(key.toUpperCase())
                    }
                    this.chooseList = window.parent.vm.videoCourse_noticeList;
                    console.log(this.chooseList)
                    this.finished = true;

                })
            },
            toggle(index, mid) {
                this.$refs.checkboxes.forEach((d, f) => {
                    if (d.name == mid.userId) {
                        this.$refs.checkboxes[f].toggle();
                    }
                })
            },
            search() {
                if (!this.searchval) return;
                ajax({
                    url: "community/threeCommendRefer/see/all/Refer",
                    data: {
                        key: this.searchval,
                    }
                }).then(res => {
                    this.searchList = res.data;
                })

            },
            onclickLeft() {
                window.parent.vm.friendListShow = false;
                // if (isAndroid) {
                //     window.history.back(-1)
                // }
            },
            onClickRight() {
                if (this.chooseList.length == 0) {
                    return
                }
                window.parent.vm.videoCourse_noticeList = this.chooseList
                window.parent.vm.friendListShow = false

            }

        }
    })
</script>

</html>