<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport"
		content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
	<title>周报月报</title>
	<link rel="stylesheet" href="font/iconfont.css">
	<link rel="stylesheet" href="css/index.css">
	<script src="https://cdn.bootcdn.net/ajax/libs/vConsole/3.8.1/vconsole.min.js"></script>
		<script>
			// init vConsole
		        var vConsole = new VConsole();
				localStorage.setItem("202199",1)
		      
		    </script>

</head>

<body>
	<div id="app" v-cloak>
		<div class="header">
			<div class="headerLeftBox" @click="goback">
				<span class="icon iconfont icon-fanhuianniu" style="font-size: 0.48rem;"></span>
			</div>
			<div class="headerTitle">周报月报</div>
			<div class="headerRightBox"></div>
		</div>
		<div class="listBox main-contain">
			<div class="weekItem" @click="goReport(1)">
				<div class="title">运动周报</div>
				<div class="date">{{lastWeek.startDateTime+'-'+lastWeek.endDateTime}}</div>
			</div>
			<div class="monthItem" @click="goReport(2)">
				<div class="title">运动月报</div>
				<div class="date">{{lastMonth.startDateTime}}</div>
			</div>
		</div>

	</div>
</body>
<script src="https://oss.laisitech.com/0bb12bf1-cb87-4d2c-a724-8a7c25b7ae04.js"></script>
<script src="../common/js/network.js"></script>
<script>
	new Vue({
		el: '#app',
		data() {
			return {
				lastWeek: {},
				lastMonth: {}

			};
		},
		filters: {

		},
		created() {

		},
		mounted() {
			this.lastWeek = this.getLastWeek(new Date())
			this.lastMonth = this.getLastMonth(new Date())
		},
		methods: {
			goback() {
				Interaction.closePage()
				localStorage.removeItem("report_startTime")
				localStorage.removeItem("report_endTime")
			},
			goReport(flag) {
				let times={}
				if(flag==1){
					times=this.lastWeek
					window.location.href = `weekReport.html`
				}else{
					times=this.lastMonth
					window.location.href =`monthReport.html`
				}
				
				localStorage.setItem("report_startTime", times.startTime)
				localStorage.setItem("report_endTime", times.endTime)
			},
			getTime(time) {
				var myDate = new Date(time);
				var u = navigator.userAgent;
				var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1; //android终端
				var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
				if (isiOS) {
					var t = new Date(time.replace(/-/g, '/')).getTime();
				} else {
					var t = myDate.getTime();
				}
				return t;
			},
			getLastWeek(value) {
				if (value == '' || value == undefined) {
					return value
				}
				if (value.length == 10) {
					value = value * 1000
				}


				let myDate = new Date(value - 7 * 24 * 3600 * 1000)
				let day = myDate.getDay() // 回退7天后是星期几？

				let time = myDate.getDate() - day + (day === 0 ? -6 : 1)
				let startTime = new Date(myDate.setDate(time))
				let startDateTime =
					(startTime.getMonth() + 1) +
					'月' +
					startTime.getDate() +
					'日'
				let startDateTime2 = (startTime.getFullYear()) + "-" + (startTime.getMonth() + 1) + '-' + startTime
					.getDate()


				let endTime = new Date(myDate.setDate(time + 6))
				let endDateTime = (endTime.getMonth() + 1) +
					'月' +
					endTime.getDate() +
					'日'
				let endDateTime2 = (endTime.getFullYear()) + "-" + (endTime.getMonth() + 1) + '-' + endTime
					.getDate()
				return {
					startDateTime: startDateTime,
					endDateTime: endDateTime,
					startTime: new Date(startDateTime2).getTime(),
					endTime: new Date(endDateTime2).getTime(),
				}
			},
			getLastMonth(value) {
				if (value == '' || value == undefined) {
					return value
				}
				if (value.length == 10) {
					value = value * 1000
				}
				// 获取上个月时间
				let nowdays = new Date(value)
				let year = nowdays.getFullYear()
				let month = nowdays.getMonth()
				if (month === 0) {
					month = 12
					year = year - 1
				}
				if (month < 10) {
					month = '0' + month
				}

				let yDate = new Date(year, month, 0)

				startDateTime = year + '年' + month + '月' //上个月第一天
				startDateTime2 = year + '-' + month + '-' + 1
				endDateTime = year + '-' + month + '-' + yDate.getDate() //上个月最后一天

				return {
					startDateTime: startDateTime,
					endDateTime: endDateTime,
					startTime: new Date(startDateTime2).getTime(),
					endTime: new Date(endDateTime).getTime(),
				}
			}


		}
	})
</script>

</html>